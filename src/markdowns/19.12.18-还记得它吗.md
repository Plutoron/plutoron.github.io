```
import ReactDOM from 'react-dom'
import { Modal, Alert } from 'antd'

// 备注：本来想传参对象的，但别人用了，改动的话工作量太大。先这样定义，看以后时机推动修改吧。
const errorEater = ({ code, message }, title, afterClose = () => {}) => {
  const errorMap = new Map([
    ['0', 'default'],
    ['1', 'info'],
    ['2', 'warning'],
    ['3', 'error']
  ])

  const errorType =
    code && errorMap.get(code[0]) ? errorMap.get(code[0]) : 'error'

  const afterCloseCallback = () => {
    window.errorEaterStackLock = false

    window.errorEaterMsgStack.shift()

    afterClose({
      type: errorType,
      code,
      message
    })

    if (window.errorEaterStack && window.errorEaterStack.length > 0) {
      window.errorEaterStackLock = true
      const next = window.errorEaterStack.shift()

      next()
    }
  }

  const renderError = () => {
    Modal.error({
      title: title || '请求错误',
      content: message || '',
      okText: '知道了',
      mask: true,
      onOk: () => {
        afterCloseCallback()
      },
      onCancel: () => {
        afterCloseCallback()
      }
    })
  }

  const renderAlert = () => {
    const wrap = document.createElement('div')

    document.body.appendChild(wrap)

    const maskStyle = {
      position: 'fixed',
      top: 0,
      right: 0,
      left: 0,
      bottom: 0,
      height: '100%',
      zIndex: 9999
    }

    const alertWrapStyle = {
      position: 'absolute',
      top: 50,
      left: '50%',
      maxWidth: '80%',
      zIndex: 9999,
      transform: 'translateX(-50%)',
      width: 560
    }

    ReactDOM.render(
      <div
        style={{ ...maskStyle }}
        onClick={() => {
          ReactDOM.unmountComponentAtNode(wrap)
          document.body.removeChild(wrap)
          afterCloseCallback()
        }}
      >
        <div style={{ ...alertWrapStyle }}>
          <Alert
            message={message}
            type={errorType}
            afterClose={() => {
              ReactDOM.unmountComponentAtNode(wrap)
              document.body.removeChild(wrap)
              afterCloseCallback()
            }}
            style={{
              paddingRight: 50,
              wordBreak: 'break-all',
              textAlign: 'justify'
            }}
            showIcon
            closable
          />
        </div>
      </div>,
      wrap
    )
  }

  const judgeAction = action => {
    if (window.errorEaterStack && window.errorEaterStack.length > 0) {
      window.errorEaterStack.push(action)
      window.errorEaterMsgStack.push(message)
    } else if (window.errorEaterStackLock) {
      window.errorEaterStack.push(action)
      window.errorEaterMsgStack.push(message)
    } else {
      window.errorEaterStackLock = true
      window.errorEaterStack = []
      window.errorEaterMsgStack = [message]
      action()
    }
  }

  if (errorType === 'default') return null

  if (errorType === 'error') {
    if (
      window.errorEaterMsgStack &&
      window.errorEaterMsgStack.length > 0 &&
      window.errorEaterMsgStack.some(v => v === message)
    )
      return null

    judgeAction(renderError)
  }

  if (errorType === 'info' || errorType === 'warning') {
    judgeAction(renderAlert)
  }
}

export default errorEater

```