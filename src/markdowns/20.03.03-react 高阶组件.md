### react 高阶组件

高阶组件（HOC）是React开发中的特有名词，一个函数返回一个React组件，指的就是一个React组包裹着另一个React组件。可以理解为一个生产React组件的工厂。

有两种类型的HOC：

实现高阶组件的方法有如下两种。

属性代理(props proxy)。属性组件通过被包裹的 React 组件来操作 props。
反向代理(inheritance inversion)。高阶组件继承于被包裹的 React 组件。


#### Props Proxy

在pp中，我们可以对WrappedComponent进行以下操作：

操作props（增删改）
通过refs访问到组件实例
提取state
用其他元素包裹WrappedComponent

```
const MyContainer = (WrappedComponent) => {
    return class extends Component {
        render() {
            return (
                <WrappedComponent
                    {...props}
                />
            )
        }
    }
}

export default MyContainer;
```
在 render 方法中返回传入 WrappedComponent 的 React 组件。这样就可以通过高阶组件来传递 props，这种方法即为属性代理。


#### Inheritance Inversion

我们可以使用Inheritance Inversion实现以下功能：

渲染劫持（Render Highjacking）
操作state

```
function iiHOC(WrappedComponent) {
  return class Enhancer extends WrappedComponent {
    render() {
      return super.render()
    }
  }
}
```

##### 条件渲染

```
function iiHOC(WrappedComponent) {
  return class Enhancer extends WrappedComponent {
    render() {
      if (!this.props.loading) {
        return super.render()
      } else {
        return <div>loading</div>    
      }
    }
  }
}
```

##### 修改渲染

```
function iiHOC(WrappedComponent) {
  return class Enhancer extends WrappedComponent {
    render() {
      const elementsTree = super.render()
      let newProps = {};
      if (elementsTree && elementsTree.type === 'input') {
        newProps = {value: 'may the force be with you'}
      }
      const props = Object.assign({}, elementsTree.props, newProps)
      const newElementsTree = React.cloneElement(elementsTree, props, elementsTree.props.children)
      return newElementsTree
    }
  }
}
```



#### 高阶组件参数

```
function HOCFactoryFactory(...params) {
    return function HOCFactory(WrappedComponent) {
        return class HOC extends Component {
            render() {
                return (
                    <WrappedComponent 
                        {...this.props}
                    />
                );
            }
        }
    }
}
```
eg: Form.create()(Component)