### node 简易 本地静态服务

```
const http = require('http')
const url = require('url')
const fs = require('fs')
const path = require('path')

const item = (name, parentPath) => {
	const path = (parentPath = `${parentPath}/${name}`.slice(1))
	return `<div><a href="${path}">${name}</a></div>`
}

const list = (arr, parentPath) => {
	return arr.map((name) => item(name, parentPath)).join('')
}

const server = http.createServer((req, res) => {
	let _path = url.parse(req.url).pathname //去掉search
	let parentPath = _path
	_path = path.join(__dirname, _path)
	try {
		// 拿到路径所对应的文件描述对象
		const stats = fs.statSync(_path)
		if (stats.isFile()) {
			// 是文件，返回文件内容
			const file = fs.readFileSync(_path)
			res.end(file)
		} else if (stats.isDirectory()) {
			// 是目录，返回目录列表，让用户可以继续点击
			const dirArray = fs.readdirSync(_path)
			res.end(list(dirArray, parentPath))
		} else {
			res.end()
		}
	} catch (err) {
		res.writeHead(404, 'Not Found')
		res.end()
	}
})

const port = 9000
const hostname = '127.0.0.1'
server.listen(port, hostname, () => {
	console.log(`server is running on http://${hostname}:${port}`)
})
 

```